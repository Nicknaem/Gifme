<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
*{
    margin:0;
    padding:0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
header{
    display: flex;
    flex-direction: column;
    align-items: center;
    border-bottom: 1px solid rgba(0,0,0,0.2);
}
header > * {
    margin:10px 0px;
}
nav{
    display: flex;
}
.container{
    width: 1200px;
    margin: auto;
}
#gifs-section{
    display: flex;
    flex-wrap: wrap;
}
#gifs-section img{
    height: 200px;
}

.search-bar{
    display: flex;
}
@media (max-width: 1300px){
    .container{
        width: 80%;
        overflow: hidden;
    }
}
</style>
<body>
    <header>
        <h1 class="title">Giphy API Example</h1>
        <nav class="nav-tags">
            <!-- contains always 6 elements -->
        </nav>
        <div class="search-bar">
            <!-- <form action=""> -->
                <input type="text" name="" id="">
                <input id="submit" type="submit" value="Submit">
            <!-- </form> -->
            <button id="trending">See what's trending</button>
        </div>
    </header>
    <main id="gifs-section" class="container">
        <!-- rendered gifs go here -->
        <!-- <div>
            <img src="" alt="">
            <div>Rating</div>
        </div> -->
    </main>
</body>
<script>
    class Config{
        constructor(){
            this.apiKey = "aFFKTuSMjd6j0wwjpFCPXZipQbcnw3vB"
            this.amount = 20;
            this.navTags = ['Internet Cats', 'Meme\'s', 'Typing', 'Space', 'Rick and Morty' ]
            this.apiURL = 'https://api.giphy.com/v1/gifs/';
            this.apiTrending = 'https://api.giphy.com/v1/gifs/trending?limit=10&api_key=aFFKTuSMjd6j0wwjpFCPXZipQbcnw3vB&fmt=json'
            // this.InputData = gifList;
        }
    }

    class Gallery extends Config {
        // appendNode(node,targetNode){
        //     targetNode.appendChild(node);
        // }

        async pullData(tabName){
            let response
            if(tabName === "See what's trending"){
                console.log('pulling trending gifs')
                response = await fetch(`${this.apiURL}trending?limit=${this.amount}\&api_key=${this.apiKey}`);
            }else{
                console.log("pulling queried gifs");
                response = await fetch(`${this.apiURL}search?q=${tabName}\&limit=${this.amount}&api_key=${this.apiKey}`);
            }
            return response.json();
        }

        loadTags(){
            let navContainer = document.querySelector('.nav-tags')
            navContainer.innerHTML = '';
            this.navTags.forEach((item)=>{
                let tagNode = document.createElement('button');
                tagNode.innerText = item;
                tagNode.addEventListener('click', (event)=>{
                    document.getElementById('gifs-section').innerHTML = '';

                    this.pullData(event.target.innerText).then((result)=>{
                        this.renderGifs(result.data);
                    })
                })
                navContainer.appendChild(tagNode)
            })
        }
        updateTags(newTag){
            this.navTags.shift();
            this.navTags.push(newTag);
            this.loadTags();
        }
        createGifBox(gifLink){
            let gifBox = document.createElement('div');
            gifBox.className = "gif-box";

            let img = document.createElement('img')
            img.setAttribute('src',gifLink);

            let gifBar = document.createElement('div')
            gifBar.innerText = 'Rating';

            gifBox.appendChild(img);
            gifBox.appendChild(gifBar);
            return gifBox
        }
        renderGifs(gifList){
            console.log(gifList);
            let gifSection = document.getElementById('gifs-section')
            gifList.forEach((item)=>{
                gifSection.appendChild(this.createGifBox(item.images.downsized.url));
            })
            //create gif element from given json object
            //append them to container
        }
    }

    var gallery = new Gallery();
    gallery.loadTags();
    
    document.getElementById('trending').addEventListener('click' , (event)=>{
        gallery.pullData(event.target.innerText).then((result)=>{
            gallery.renderGifs(result.data);
        });
    })
    document.getElementById('submit').addEventListener('click', (event)=>{
        let inputValue = event.target.parentElement.firstElementChild.value
        gallery.pullData(inputValue).then((result)=>{
            gallery.renderGifs(result.data);
        })
        gallery.updateTags(inputValue);
        inputValue = '';
        
    })
    // on navTags click
    //   wipe out Gallery container 
    //   generate queryURL based on target.innerText and Config paremeters
    //   then fetch get all the data as array of objects
    //   and render them

    //on submit
    //  goes same, we just unshift first value in navTags array and push new one there

</script>
</html>